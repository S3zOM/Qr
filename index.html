<!DOCTYPE html>
<html lang="mn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MBTI –°—É–¥–ª–∞–∞—á</title>
    <meta
      name="description"
      content="–ù—ç–≥ —Ñ–∞–π–ª–¥ –±“Ø—Ö –∑“Ø–π–ª: MBTI —Ç–µ—Å—Ç, –¥–∏–Ω–∞–º–∏–∫ –≥—Ä–∞—Ñ–∏–∫, 16 —Ç”©—Ä–ª–∏–π–Ω —Ç–∞–π–ª–±–∞—Ä, —Ö—É–≤–∞–∞–ª—Ü–∞—Ö –±–∞ —Ö—ç–≤–ª—ç—Ö ‚Äî –º–∞—à —Ö—É—Ä–¥–∞–Ω, –Ω—É—É—Ü–ª–∞–ª—Ç–∞–π."
    />
  </head>
  <body>
    <style>
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          Cantarell, Noto Sans, sans-serif;
        line-height: 1.55;
      }
      img,
      svg {
        display: block;
        max-width: 100%;
      }
      button,
      input,
      select {
        font: inherit;
      }

      /* ===== THEME ===== */
      :root {
        --bg: #0b1020;
        --bg-soft: #0e1430;
        --surface: rgba(255, 255, 255, 0.06);
        --text: #f4f7ff;
        --muted: #b7c1e1;
        --brand: #6aa4ff;
        --brand-2: #9b7bff;
        --ok: #35d69a;
        --warn: #ffb545;
        --bad: #ff6b6b;
        --shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
        --radius: 20px;
      }
      .light {
        --bg: #f6f7fb;
        --bg-soft: #eef1fb;
        --surface: rgba(0, 0, 0, 0.05);
        --text: #0f1330;
        --muted: #4b5379;
        --brand: #3b7cff;
        --brand-2: #7f63ff;
        --shadow: 0 10px 40px rgba(0, 0, 0, 0.12);
      }

      body {
        background: radial-gradient(
            1300px 600px at 10% -10%,
            rgba(106, 164, 255, 0.22),
            transparent 60%
          ),
          radial-gradient(
            800px 400px at 90% 10%,
            rgba(155, 123, 255, 0.22),
            transparent 60%
          ),
          linear-gradient(180deg, var(--bg) 0%, var(--bg-soft) 100%);
        color: var(--text);
        overflow-x: hidden;
        background-repeat: no-repeat;
        background-attachment: fixed;
      }

      /* Animated gradient mist */
      body::before,
      body::after {
        content: "";
        position: fixed;
        inset: -20vmax;
        z-index: -1;
        filter: blur(60px);
        opacity: 0.6;
        pointer-events: none;
        background: conic-gradient(
          from 180deg,
          rgba(106, 164, 255, 0.25),
          rgba(155, 123, 255, 0.25),
          rgba(106, 164, 255, 0.25)
        );
        animation: swirl 22s linear infinite;
      }
      body::after {
        animation-duration: 34s;
        mix-blend-mode: screen;
        opacity: 0.4;
      }
      @keyframes swirl {
        from {
          transform: rotate(0deg) scale(1.05);
        }
        to {
          transform: rotate(360deg) scale(1.05);
        }
      }

      /* ===== LAYOUT ===== */
      header {
        position: fixed;
        width: 100%;
        background-color: #0e143075;
        top: 0;
        left: 0;
        z-index: 50;
        height: 80px;
        display: flex;
        align-items: center;
      }
      .container {
        max-width: 1100px;
        margin-inline: auto;
        padding: 1rem clamp(1rem, 3vw, 2rem);
      }
      .nav {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        justify-content: space-between;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        font-weight: 800;
        letter-spacing: 0.2px;
        cursor: pointer;
      }
      .brand .logo {
        width: 28px;
        height: 28px;
        border-radius: 9px;
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.35);
        animation: popIn 0.6s ease both;
      }
      @keyframes popIn {
        from {
          transform: scale(0.6);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .nav a {
        color: var(--muted);
        text-decoration: none;
        font-weight: 700;
        padding: 0.5rem 0.75rem;
        border-radius: 12px;
        transition: transform 0.12s ease, background 0.2s ease;
      }
      .nav a:hover {
        background: var(--surface);
        color: var(--text);
        transform: translateY(-2px);
      }

      .controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .btn,
      button[role="button"] {
        border: none;
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        color: white;
        padding: 0.75rem 1rem;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 800;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
        transform: translateZ(0);
      }
      .btn.ghost {
        background: transparent;
        color: var(--text);
        border: 1px solid rgba(255, 255, 255, 0.18);
        box-shadow: none;
      }
      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .btn:active {
        transform: translateY(1px);
      }

      /* Ripple micro-interaction */
      .btn::after {
        content: "";
        position: absolute;
        inset: auto auto 50% 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.35);
        transform: translate(-50%, -50%);
        opacity: 0;
      }
      .btn.rippling::after {
        animation: ripple 0.6s ease;
      }
      @keyframes ripple {
        from {
          width: 0;
          height: 0;
          opacity: 0.6;
        }
        to {
          width: 420px;
          height: 420px;
          opacity: 0;
        }
      }

      main {
        display: grid;
        gap: 2rem;
        padding-top: 80px;
      }
      .hero {
      }
      .hero-grid {
        display: grid;
        grid-template-columns: 1.2fr 0.8fr;
        gap: clamp(1rem, 3vw, 2rem);
        align-items: center;
      }
      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.06),
          rgba(255, 255, 255, 0.03)
        );
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
      }
      .p-lg {
        padding: clamp(1rem, 3vw, 2rem);
      }
      .p-md {
        padding: 1rem;
      }
      .title {
        font-size: clamp(1.9rem, 3vw, 2.6rem);
        margin: 0 0 0.5rem;
      }
      .subtitle {
        color: var(--muted);
        font-weight: 600;
        margin: 0 0 1rem;
      }

      .features {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
      }
      .feature {
        padding: 1rem;
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px dashed rgba(255, 255, 255, 0.15);
        transition: transform 0.2s ease, background 0.2s ease;
      }
      .feature:hover {
        transform: translateY(-3px) scale(1.01);
        background: rgba(255, 255, 255, 0.07);
      }

      .section {
        scroll-margin-top: 80px;
      }

      .grid {
        display: grid;
        gap: 1rem;
      }
      .grid.cols-2 {
        grid-template-columns: repeat(2, 1fr);
      }
      .grid.cols-3 {
        grid-template-columns: repeat(3, 1fr);
      }
      .grid.cols-4 {
        grid-template-columns: repeat(4, 1fr);
      }

      @media (max-width: 900px) {
        .hero-grid {
          grid-template-columns: 1fr;
        }
        .features,
        .grid.cols-2,
        .grid.cols-3,
        .grid.cols-4 {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 0.5rem;
        }
        .nav {
          flex-wrap: wrap;
          gap: 0.5rem;
        }
        .brand {
          font-size: 0.9rem;
        }
        .title {
          font-size: 1.5rem;
        }
        .subtitle {
          font-size: 0.9rem;
        }
        .features {
          gap: 0.5rem;
        }
        .feature {
          padding: 0.75rem;
          font-size: 0.9rem;
        }
        .scale {
          grid-template-columns: repeat(4, 1fr);
          gap: 0.25rem;
        }
        .pill {
          padding: 0.5rem 0.25rem;
          font-size: 0.75rem;
        }
        .quiz-controls {
          flex-direction: column;
          align-items: stretch;
          gap: 1rem;
        }
        .quiz-controls .left,
        .quiz-controls .right {
          justify-content: center;
        }
        .result-header {
          flex-direction: column;
          align-items: stretch;
        }
        .bars {
          gap: 0.75rem;
        }
        .bar {
          height: 16px;
        }
        .type-card {
          padding: 0.75rem;
        }
      }

      /* ===== REVEAL ANIMATIONS ===== */
      .reveal {
        opacity: 0;
        transform: translateY(12px) scale(0.98);
        transition: opacity 0.6s ease;
      }
      .in-view {
        opacity: 1 !important;
        transform: none !important;
      }

      /* ===== QUIZ ===== */
      .quiz-progress {
        height: 10px;
        background: rgba(255, 255, 255, 0.08);
        border-radius: 999px;
        overflow: hidden;
      }
      .quiz-bar {
        height: 100%;
        background: linear-gradient(90deg, var(--brand), var(--brand-2));
        width: 0%;
        transition: width 0.5s cubic-bezier(0.22, 1, 0.36, 1);
      }
      .question {
        font-weight: 900;
        margin-bottom: 0.25rem;
      }
      .scale {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 0.5rem;
        align-items: center;
        margin-top: 0.75rem;
      }
      .scale input {
        display: none;
      }
      .pill {
        padding: 0.65rem 0.5rem;
        text-align: center;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.14);
        cursor: pointer;
        user-select: none;
        font-weight: 800;
        transition: transform 0.06s linear, background 0.15s ease,
          border 0.15s ease;
      }
      .pill:hover {
        outline: 2px solid rgba(255, 255, 255, 0.2);
        transform: translateY(-1px);
      }
      .scale input:checked + .pill {
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        color: white;
        border-color: transparent;
        box-shadow: var(--shadow);
        animation: pulse 0.4s ease;
      }
      @keyframes pulse {
        from {
          transform: scale(0.98);
        }
        50% {
          transform: scale(1.02);
        }
        to {
          transform: scale(1);
        }
      }
      .pill.small {
        font-size: 0.8rem;
        font-weight: 900;
        opacity: 0.85;
      }

      .quiz-controls {
        display: flex;
        gap: 0.5rem;
        justify-content: space-between;
        align-items: center;
        margin-top: 0.75rem;
      }
      .quiz-controls .left {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      /* ===== RESULTS ===== */
      .result-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        flex-wrap: wrap;
      }
      .badge {
        padding: 0.4rem 0.7rem;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.18);
        font-weight: 900;
      }
      .bars {
        display: grid;
        gap: 0.5rem;
      }
      .bar {
        height: 12px;
        background: rgba(255, 255, 255, 0.08);
        border-radius: 999px;
        overflow: hidden;
        position: relative;
      }
      .bar > span {
        position: absolute;
        inset: 0 50% 0 0;
        background: linear-gradient(90deg, var(--brand), var(--brand-2));
        transition: inset 0.6s cubic-bezier(0.22, 1, 0.36, 1);
      }
      .bar .label {
        position: absolute;
        inset: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.8rem;
        color: var(--muted);
        font-weight: 800;
        padding: 0 0.5rem;
      }

      /* ===== TYPES DIRECTORY ===== */
      .type-card {
        padding: 1rem;
        border-radius: 16px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        background: rgba(255, 255, 255, 0.05);
        display: grid;
        gap: 0.35rem;
        transition: transform 0.18s ease, background 0.2s ease;
      }
      .type-card:hover {
        transform: translateY(-3px);
        background: rgba(255, 255, 255, 0.07);
      }

      /* ===== UTIL ===== */
      .sr-only {
        position: absolute;
        left: -9999px;
        width: 1px;
        height: 1px;
        overflow: hidden;
      }
      .muted {
        color: var(--muted);
      }
      .kbd {
        font-weight: 900;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 0.15rem 0.35rem;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.08);
      }
      .flex {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }
      .right {
        margin-left: auto;
      }
    </style>

    <header>
      <div class="container nav" role="navigation" aria-label="“Æ–Ω–¥—Å—ç–Ω —Ü—ç—Å">
        <div class="brand" onclick="scrollToId('top')">
          <img class="logo" src="mbtilogo.png" alt="" />
          <span>MBTI C—É–¥–∞–ª–≥–∞–∞</span>
        </div>
        <nav class="flex">
          <a href="#quiz" onclick="scrollToId('quiz')">–¢–µ—Å—Ç</a>
          <a href="#types" onclick="scrollToId('types')">16 —Ç”©—Ä”©–ª</a>
          <a href="#compare" onclick="scrollToId('compare')">–•–∞—Ä—å—Ü—É—É–ª–∞—Ö</a>
          <a href="#about" onclick="scrollToId('about')">–¢—É—Ö–∞–π</a>
        </nav>
        <div class="controls">
          <button class="btn ghost" id="themeToggle" title="–ì—ç—Ä—ç–ª/—Ö–∞—Ä–∞–Ω—Ö—É–π">
            üåó
          </button>
          <button class="btn" onclick="scrollToId('quiz')">–≠—Ö–ª—ç—Ö</button>
        </div>
      </div>
    </header>

    <main id="top" class="container">
      <!-- HERO -->
      <section
        class="hero section card p-lg reveal"
        aria-labelledby="hero-title"
      >
        <div class="hero-grid">
          <div>
            <h1 class="title" id="hero-title">”®”©—Ä–∏–π–Ω —Ö—ç–Ω –±–æ–ª–æ—Ö—ã–≥ –º—ç–¥. ‚ú®</h1>
            <p class="subtitle">
              –¢–∞–Ω—ã —Ö—ç–Ω –±–æ–ª–æ—Ö –º”©–Ω —è–∞–≥–∞–∞–¥ –∏–π–º “Ø–π–ª–¥–ª“Ø“Ø–¥ —Ö–∏–π–¥—ç–≥ —Ç—É—Ö–∞–π ‚Äú–≥–∞–π—Ö–∞–ª—Ç–∞–π
              “Ø–Ω—ç–Ω –∑”©–≤‚Äù —Ç–æ–¥–æ—Ä—Ö–æ–π–ª–æ–ª—Ç—ã–≥ –æ–ª–∂ –∞–≤–∞—Ö–∞–¥ –µ—Ä–¥”©”© 10 –º–∏–Ω—É—Ç –∑–∞—Ä—Ü—É—É–ª–∞–≥–¥–∞–Ω–∞.
            </p>
            <div class="features">
              <div class="feature reveal">
                <strong>‚ö° –ù—ç–≥ —Ñ–∞–π–ª.</strong><br />—à—É—É–¥ –∞—á–∞–∞–ª–Ω–∞.
              </div>
              <div class="feature reveal">
                <strong>üß≠ –¢–æ–¥ –¥“Ø–≥–Ω—ç–ª—Ç.</strong><br />–•–∞—Ä–∏—É–ª—Ç –±“Ø—Ä–∏–π–≥ —à—É—É–¥
                —Ö—è–Ω–∞–Ω–∞.
              </div>
              <div class="feature reveal">
                <strong>üîí –ù—É—É—Ü–ª–∞–ª.</strong><br />–¢–∞–Ω—ã ”©–≥”©–≥–¥”©–ª—ã–≥ –Ω—É—É—Ü–ª–∞–ª—Ç–∞–π
                –±–∞–π–ª–≥–∞–Ω–∞.
              </div>
            </div>
            <div class="flex" style="margin-top: 1rem">
              <button class="btn" onclick="scrollToId('quiz')">
                –¢–µ—Å—Ç ”©–≥”©—Ö
              </button>
              <button class="btn ghost" onclick="window.print()">
                üñ®Ô∏è –•—ç–≤–ª—ç—Ö/ PDF
              </button>
            </div>
          </div>
          <div class="card p-md reveal" aria-live="polite">
            <h3 style="margin: 0.25rem 0">–°“Ø“Ø–ª—á–∏–π–Ω –¥“Ø–Ω</h3>
            <p class="muted" id="lastResultNote">
              –û–¥–æ–æ–≥–æ–æ—Ä –¥“Ø–Ω –∞–ª–≥–∞. –≠—Ö–ª—ç—ç–¥ —Ç–µ—Å—Ç ”©–≥–Ω”© “Ø“Ø.
            </p>
            <div id="lastResult" class="grid" style="display: none">
              <div class="result-header">
                <div>
                  <div class="badge" id="lastType">XXXX</div>
                  <div class="muted" id="lastNickname">‚Äî</div>
                </div>
                <div class="flex">
                  <button class="btn ghost" id="shareBtn">–•—É–≤–∞–∞–ª—Ü–∞—Ö</button>
                  <button class="btn" id="restartBtn">–î–∞—Ö–∏–Ω ”©–≥”©—Ö</button>
                </div>
              </div>
              <div class="bars" id="lastBars"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- QUIZ -->
      <section
        id="quiz"
        class="section card p-lg reveal"
        aria-labelledby="quiz-title"
      >
        <h2 class="title" id="quiz-title">MBTI –¢–µ—Å—Ç</h2>

        <div class="quiz-progress" aria-hidden="true">
          <div class="quiz-bar" id="quizBar"></div>
        </div>
        <ol id="quizList" class="grid" style="margin-top: 1rem"></ol>
        <div class="quiz-controls">
          <div class="left">
            <button class="btn ghost" id="backBtn">‚üµ –ë—É—Ü–∞—Ö</button>
            <span class="muted" id="qCounter">0 / 0</span>
          </div>
          <div class="right flex">
            <button class="btn ghost" id="clearBtn">–¶—ç–≤—ç—Ä–ª—ç—Ö</button>
            <button class="btn" id="finishBtn">–î—É—É—Å–≥–∞—Ö</button>
          </div>
        </div>
      </section>

      <!-- RESULTS -->
      <section
        id="results"
        class="section card p-lg reveal"
        aria-labelledby="results-title"
        style="display: none"
      >
        <h2 class="title" id="results-title">–¢–∞–Ω—ã –¥“Ø–Ω</h2>
        <div class="result-header">
          <div>
            <div class="badge" id="resType">XXXX</div>
            <div class="muted" id="resNick">‚Äî</div>
          </div>
          <div class="flex">
            <button class="btn ghost" id="copyLink">–•–æ–ª–±–æ–æ—Å —Ö—É—É–ª–∞—Ö</button>
            <button class="btn" id="shareResult">–•—É–≤–∞–∞–ª—Ü–∞—Ö</button>
          </div>
        </div>
        <div class="grid cols-2" style="margin-top: 1rem">
          <div>
            <h3>–ó–∞–¥–ª–∞–ª</h3>
            <div class="bars" id="resBars"></div>
            <p class="muted" style="margin-top: 0.75rem">
              –ò—Ö —Ö—É–≤—å = —Ç—É—Ö–∞–π–Ω —Ö–æ—Å—ã–Ω —ç—Ö–Ω–∏–π “Ø—Å–≥–∏–π–≥ –∏–ª“Ø“Ø –∏–ª—ç—Ä—Ö–∏–π –¥–∞–≤—É—É.
            </p>
          </div>
          <div>
            <h3><span id="aboutCode">XXXX</span> ‚Äî –¢—É—Ö–∞–π</h3>
            <p id="resAbout" class="muted"></p>
            <h4 style="margin: 0.5rem 0 0">–î–∞–≤—É—É —Ç–∞–ª</h4>
            <ul id="resStrengths"></ul>
            <h4 style="margin: 0.75rem 0 0">”®—Å”©—Ö —Å–∞–Ω–∞–∞</h4>
            <ul id="resGrowth"></ul>
          </div>
        </div>
      </section>

      <!-- TYPES DIRECTORY -->
      <section
        id="types"
        class="section card p-lg reveal"
        aria-labelledby="types-title"
      >
        <h2 class="title" id="types-title">16 —Ç”©—Ä”©–ª</h2>
        <div id="typesGrid" class="grid cols-4"></div>
      </section>

      <!-- COMPARE -->
      <section
        id="compare"
        class="section card p-lg reveal"
        aria-labelledby="compare-title"
      >
        <h2 class="title" id="compare-title">–¢”©—Ä–ª“Ø“Ø–¥–∏–π–≥ —Ö–∞—Ä—å—Ü—É—É–ª–∞—Ö</h2>
        <div class="grid cols-2">
          <div>
            <label for="cmpA" class="muted">–ê —Ç”©—Ä”©–ª</label>
            <select id="cmpA"></select>
          </div>
          <div>
            <label for="cmpB" class="muted">–ë —Ç”©—Ä”©–ª</label>
            <select id="cmpB"></select>
          </div>
        </div>
        <div class="grid cols-2" style="margin-top: 1rem">
          <div class="type-card" id="cmpACard"></div>
          <div class="type-card" id="cmpBCard"></div>
        </div>
      </section>

      <!-- ABOUT -->
      <section
        id="about"
        class="section card p-lg reveal"
        aria-labelledby="about-title"
      >
        <h2 class="title" id="about-title">–°–∞–π—Ç—ã–Ω —Ç—É—Ö–∞–π</h2>
        <p class="muted">
          –≠–Ω—ç –±–æ–ª MBTI —Ö“Ø—Ä—ç—ç–Ω—ç—ç—Å —Å–∞–Ω–∞–∞ –∞–≤—Å–∞–Ω —Å—É—Ä–∞–ª—Ü–∞—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª (4 —Ö–æ—Å–ª–æ–ª:
          –≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ü/–ò–Ω—Ç—Ä–∞–≤–µ—Ä—Ü, –ú—ç–¥—Ä—ç—Ö“Ø–π/–ó”©–Ω —Å–æ–≤–∏–Ω, –ë–æ–¥–æ–ª/–ú—ç–¥—Ä—ç–º–∂,
          –®“Ø“Ø—Ö/–¢–∞–π–ª–±–∞—Ä–ª–∞—Ö). –ë—É—Å–∞–¥ —Å–∞–π—Ç–Ω–∞–∞—Å —Å–∞–Ω–∞–∞ –∞–≤–∞–Ω —Ö–∏–π—Å—ç–Ω –±–æ–ª–Ω–æ.
        </p>
      </section>

      <footer class="container" style="padding-bottom: 3rem">
        <div class="muted">Made by 11a Zorigtbaatar.</div>
      </footer>
    </main>
  </body>
  <script>
    /** @format */

    // ===== UTIL =====
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
    const scrollToId = (id) => {
      document
        .getElementById(id)
        ?.scrollIntoView({ behavior: "smooth", block: "start" });
    };

    // Theme toggle
    const themeToggle = document.getElementById("themeToggle");
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "light") document.body.classList.add("light");
    const ripple = (btn) => {
      btn.classList.remove("rippling");
      void btn.offsetWidth;
      btn.classList.add("rippling");
      setTimeout(() => btn.classList.remove("rippling"), 600);
    };
    themeToggle.addEventListener("click", (e) => {
      document.body.classList.toggle("light");
      localStorage.setItem(
        "theme",
        document.body.classList.contains("light") ? "light" : "dark"
      );
      ripple(e.currentTarget);
    });

    // Scroll reveal
    const io = new IntersectionObserver(
      (entries) => {
        entries.forEach((en) => {
          if (en.isIntersecting) en.target.classList.add("in-view");
        });
      },
      { threshold: 0.12 }
    );
    $$(".reveal").forEach((el) => io.observe(el));

    // ===== MBTI DATA (MN) =====
    const TYPES = {
      ISTJ: {
        nick: "–•—è–Ω–∞–≥—á",
        about:
          "–ë–æ–¥–∏—Ç, —Ö–∞—Ä–∏—É—Ü–ª–∞–≥–∞—Ç–∞–π, –Ω–∞—Ä–∏–π–Ω —à–∏—Ä–∏–π–Ω–¥ –∞–Ω—Ö–∞–∞—Ä–Ω–∞. –î“Ø—Ä—ç–º, –±“Ø—Ç—ç—Ü “Ø–Ω—ç–ª–¥—ç–≥.",
        strengths: ["–ù—è–≥—Ç –Ω—è–º–±–∞–π", "–î–∞—Ä–∞–º—Ç–∞–Ω–¥ —Ç–∞–π–≤–∞–Ω", "–õ–æ–≥–∏—Å—Ç–∏–∫ —Å–∞–π–Ω"],
        growth: [
          "–î“Ø—Ä–º—ç—ç—Å —É—è–Ω —Ö–∞—Ç–∞–Ω",
          "–•—ç—Ä—ç–≥—Ü—ç—ç–≥—ç—ç –∏–ª —Ç–æ–¥ —Ö—ç–ª",
          "–®–∏–Ω—ç —Å–∞–Ω–∞–∞–≥ —Å–æ–Ω—Å–æ",
        ],
      },
      ISFJ: {
        nick: "–•–∞–º–≥–∞–∞–ª–∞–≥—á",
        about:
          "–î—É–ª–∞–∞–Ω, —á–∏–Ω “Ø–Ω—ç–Ω—á, –∑–æ—Ä–∏—É–ª–∞–≥—á. –•“Ø–º“Ø“Ø—Å–∏–π–Ω —Ç—É—Ö–∞–π –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π–≥ —Å–∞–Ω–∞–¥–∞–≥.",
        strengths: [
          "–î—ç–º–∂–∏—Ö —Ö–∞–º—Ç—Ä–∞–≥—á",
          "–¢—ç–≤—á—ç—ç—Ä—Ç—ç–π —Å–æ–Ω—Å–æ–≥—á",
          "–ê–º–ª–∞–ª—Ç–∞–∞ –±–∏–µ–ª“Ø“Ø–ª–¥—ç–≥",
        ],
        growth: [
          "–î–∞–∞–ª–≥–∞–≤–∞—Ä —Ö—É–≤–∞–∞—Ä–∏–ª",
          "–•–∏–ª—ç—ç —Ç–æ–≥—Ç–æ–æ",
          "”®”©—Ä—á–ª”©–ª—Ç”©–¥ –∞–∞–∂–º–∞–∞—Ä –¥–∞—Å",
        ],
      },
      INFJ: {
        nick: "–ú—ç—Ä–≥—ç–Ω",
        about: "–î–æ—Ç–æ–æ–¥Ê¥û—Ç –æ–π–ª–≥–æ–ª—Ç—Ç–æ–π, –∏–¥–µ–∞–ª–∏—Å—Ç, —ç–º–ø–∞—Ç. –£—Ç–≥–∞ —É—á—Ä—ã–≥ —ç—Ä–¥—ç–≥.",
        strengths: ["–ì“Ø–Ω —ç–º–ø–∞—Ç", "–°—Ç—Ä–∞—Ç–µ–≥–∏ –±–æ–¥–æ–ª", "–ó–æ—Ä–∏–ª–≥–æ–¥ —á–∏–≥–ª—ç—Å—ç–Ω"],
        growth: [
          "–¢”©–≥—Å —Ç”©–≥”©–ª–¥”©—Ä–∂–∏–ª—Ç –±–∞–≥–∞—Å–≥–∞",
          "–≠—Ä–≥—ç–ª–∑—ç—ç–≥—ç—ç —Ö—É–≤–∞–∞–ª—Ü",
          "–ê–º—Ä–∞—Ö —Ü–∞–≥ –∞–≤",
        ],
      },
      INTJ: {
        nick: "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä",
        about:
          "–ë–∏–µ –¥–∞–∞—Å–∞–Ω, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á, –∏—Ä—ç—ç–¥“Ø–π–¥ —Ç”©–≤–ª”©—Ä–Ω”©. –°–∏—Å—Ç–µ–º –æ–Ω–æ–≤—á—Ç–æ–π –±–æ–ª–≥–æ—Ö –¥—É—Ä—Ç–∞–π.",
        strengths: [
          "–£—Ä—Ç —Ö—É–≥–∞—Ü–∞–∞–Ω—ã —Ç”©–ª”©–≤–ª”©–ª—Ç",
          "–°–∏—Å—Ç–µ–º–∏–π–Ω —Å—ç—Ç–≥—ç–ª–≥—ç—ç",
          "”®–Ω–¥”©—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç",
        ],
        growth: [
          "–î–æ—Ç–Ω–æ –±–∞–π–¥–ª–∞–∞ –∏–ª—ç—Ä—Ö–∏–π–ª",
          "–•“Ø–º“Ø“Ø—Å—Ç—ç–π —Ç–∞–∞–º–≥–∏–π–≥ —Ç—É—Ä—à",
          "–ò–ª —Ç–æ–¥ –¥–∞–≤—Ç–∞–ª—Ç —Ö–∏–π",
        ],
      },
      ISTP: {
        nick: "–ú—ç–¥—Ä—ç–º—á—Ç—ç–π",
        about:
          "–®–∏–Ω–∂–∏–ª–≥—ç—ç—Ç—ç–π, –≥–∞—Ä –∞–∂–∏–ª–ª–∞–≥–∞–∞—Ç–∞–π –∞—Å—É—É–¥–∞–ª —à–∏–π–¥—ç–≥—á. –¢“Ø—Ä–≥—ç–Ω –¥–∞—Å–∞–Ω –∑–æ—Ö–∏—Ü–Ω–æ.",
        strengths: ["–ê–ª–¥–∞–∞ –∑–∞—Å–∞—Ö", "–ü—Ä–∞–∫—Ç–∏–∫ –±“Ø—Ç—ç—ç–ª—á", "–•—è–º—Ä–∞–ª–¥ —Ç–∞–π–≤–∞–Ω"],
        growth: [
          "–¢”©–ª”©–≤–ª”©–≥”©”©–≥”©”© —Ö—É–≤–∞–∞–ª—Ü",
          "–£—Ä—Ç –Ω”©–ª”©”©–≥ –±–æ–¥–æ–ª—Ü",
          "–¢—É—Å–ª–∞–º–∂ —Ö“Ø–ª—ç—ç–∂ –∞–≤",
        ],
      },
      ISFP: {
        nick: "–£—Ä–∞–Ω –±“Ø—Ç—ç—ç–ª—á",
        about:
          "–ó”©”©–ª”©–Ω, –∂–∏–Ω—Ö—ç–Ω—ç, —É—è–Ω —Ö–∞—Ç–∞–Ω. –•—É–≤–∏–π–Ω –∏–ª—ç—Ä—Ö–∏–π–ª—ç–ª, –∑–æ—Ö–∏—Ü–ª—ã–≥ —ç—Ä—Ö—ç–º–ª—ç–Ω—ç.",
        strengths: ["–î“Ø—Ä—Å–ª—ç—Ö –º—ç–¥—Ä—ç–º–∂", "–≠–º–ø–∞—Ç –æ—Ä—á–∏–Ω", "–£—è–Ω —Ö–∞—Ç–∞–Ω —Ç–∞–π–≤–∞–Ω"],
        growth: [
          "–•—ç—Ä—ç–≥—Ü—ç—ç–≥—ç—ç —Ö—ç–ª",
          "–£—Ä—å–¥—á–∏–ª–∞–Ω —Ç”©–ª”©–≤–ª”©",
          "–°–∞–Ω–∞–ª —Ö“Ø—Å—ç–ª—Ç–∏–π–≥ —Ö“Ø–ª—ç—ç–∂ –∞–≤",
        ],
      },
      INFP: {
        nick: "–ú”©—Ä”©”©–¥”©–≥—á",
        about: "–ò–¥–µ–∞–ª–∏—Å—Ç, “Ø–Ω—ç—Ç –∑“Ø–π–ª–¥ —Å—É—É—Ä–∏–ª—Å–∞–Ω, —Ç”©—Å”©”©–ª”©–ª –∏—Ö—Ç—ç–π.",
        strengths: ["–ë“Ø—Ç—ç—ç–ª—á —Å–∞–Ω–∞–∞", "–•“Ø–º“Ø“Ø—Å—Ç “Ø–Ω—ç–Ω—á", "–ù—ç—ç–ª—Ç—Ç—ç–π —Å—ç—Ç–≥—ç–ª–≥—ç—ç"],
        growth: [
          "–ê–ª—Ö–º—É—É–¥ –±–æ–ª–≥–æ–Ω –±—É—É–ª–≥–∞",
          "”®”©—Ä/–±—É—Å–¥—ã–≥ —Ç—ç–Ω—Ü–≤—ç—Ä–ª—ç",
          "–ë–æ–¥–∏—Ç —Ö–∏–ª —Ç–æ–≥—Ç–æ–æ",
        ],
      },
      INTP: {
        nick: "–®–∏–Ω–∂—ç—ç—á",
        about: "–°–æ–Ω–∏—É—á, –æ–Ω–æ–ª—ã–Ω, –±–∏–µ –¥–∞–∞—Å–∞–Ω. –•—ç—ç –∑–∞–≥–≤–∞—Ä—ã–≥ —Ö–∞–π—Ä–ª–∞–Ω–∞.",
        strengths: ["–õ–æ–≥–∏–∫ –∏–ª —Ç–æ–¥", "–ö–æ–Ω—Ü–µ–ø—Ç –±“Ø—Ç—ç—ç—Ö", "–û–±—ä–µ–∫—Ç–∏–≤ –∞–Ω–∞–ª–∏–∑"],
        growth: ["–≠—Ä—Ç –Ω–∏–π–ª“Ø“Ø–ª", "–•–∞—Ä–∏–ª—Ü–∞–∞–Ω—ã ”©–Ω–≥–∏–π–≥ –∞–Ω–∑–∞–∞—Ä", "–•–∞–∞–ª—Ç—É—É–¥—ã–≥ —Ö–∞–∞"],
      },
      ESTP: {
        nick: "–î–∏–Ω–∞–º–∏–∫",
        about: "–≠—Ä—á —Ö“Ø—á—Ç—ç–π, “Ø–π–ª–¥—ç–ª–¥ —Ç”©–≤–ª”©—Ä—Å”©–Ω, –Ω”©”©—Ü—Ç—ç–π. –ú–æ–º–µ–Ω—Ç–æ–¥ –∞–º—å–¥–∞—Ä–Ω–∞.",
        strengths: ["–•—É—Ä–¥–∞–Ω —à–∏–π–¥–≤—ç—Ä", "–Ø—Ç–≥–∞—Ö —á–∞–¥–≤–∞—Ä", "–ì–∞—Ä–∞–∞—Ä —Å—É—Ä–Ω–∞"],
        growth: ["–£—Ä—Ç —Ö—É–≥–∞—Ü–∞–∞–≥ –±–æ–¥", "–°–æ–Ω—Å–æ–∂ —É–¥–∞–∞—à–∏—Ä", "–≠—Ö—ç–ª—Å–Ω—ç—ç –¥—É—É—Å–≥–∞"],
      },
      ESFP: {
        nick: "–£—É—Ä –∞–º—å—Å–≥–∞–ª –±“Ø—Ç—ç—ç–≥—á",
        about: "–¶–æ–≤–æ–æ, –Ω–∞–π—Ä—Å–∞–≥, —Ü–æ—á–º–æ–≥. ”®—Ä”©”©–≥ —ç–Ω–µ—Ä–≥–∏–∂“Ø“Ø–ª–Ω—ç.",
        strengths: ["–ù–∏–π–≥–º–∏–π–Ω —Ü–∞–≤—É—É", "–î–∞—Å–∞–Ω –∑–æ—Ö–∏—Ü–æ—Ö", "–•“Ø–º“Ø“Ø—Å–∏–π–≥ –∞–∂–∏–≥–ª–∞–Ω–∞"],
        growth: ["–≠–Ω–µ—Ä–≥–∏/—Ü–∞–≥ —Ç”©—Å”©–≤–ª”©", "–î—ç–≥ –∂—É—Ä–º—ã–≥ —Ç—ç–≤—á", '–≠–µ–ª–¥–≥—ç—ç—Ä "“Ø–≥“Ø–π" –≥—ç'],
      },
      ENFP: {
        nick: "–ê–≤—å—è–∞—Å–∂—É—É–ª–∞–≥—á",
        about:
          "–î—É—Ä –±—É–ª–∞–∞–º, —Ç”©—Å”©”©–ª”©–º—Ç–≥–∏–π, —Ö“Ø–º“Ø“Ø—Å—Ç —Ç”©–≤–ª”©—Ä—Å”©–Ω. –ë–æ–ª–æ–º–∂ —Ö–∞–∞ —Å–∞–π–≥“Ø–π —Ö–∞—Ä–Ω–∞.",
        strengths: ["–°–∞–Ω–∞–∞ “Ø“Ø—Å–≥—ç–≥—á", "–≠–º–ø–∞—Ç", "–£—Ä–∞–º ”©–≥”©–≥—á"],
        growth: ["–≠—Ä—ç–º–±—ç–ª–∂ —Å—É—Ä", "–î–∞–¥–∞–ª –±–∏–π –±–æ–ª–≥–æ", "–î—É—É—Å–≥–∞–ª—Ç–∞–Ω–¥ –∞–Ω—Ö–∞–∞—Ä"],
      },
      ENTP: {
        nick: "–ú–∞—Ä–≥–∞–∞–Ω—á",
        about:
          "–°–∞–Ω–∞–∞—á–ª–∞–≥—á, —Ö—É—Ä–¥–∞–Ω —É—Ö–∞–∞–Ω, —Å–æ—Ä–∏–ª—Ç–æ–¥ –¥—É—Ä—Ç–∞–π. –°–æ–Ω–≥–æ–ª—Ç—É—É–¥—ã–≥ —Å—É–¥–∞–ª–Ω–∞.",
        strengths: [
          "–ë“Ø—Ç—ç—ç–ª—á —à–∏–π–¥—ç–ª",
          "”®”©—Ä—á–ª”©–ª—Ç”©–Ω–¥ —Ç–∞–π–≤–∞–Ω",
          "–•—ç–ª —è—Ä–∏–∞–Ω—ã –∞–≤—å—è–∞—Å",
        ],
        growth: [
          "–¢—É–ª–∞–∞–Ω–∞–∞ —Å–æ–Ω–≥–æ",
          "–¢—É—Ä—à–∏–ª—Ç—ã–≥ –¥—É—É—Å–≥–∞",
          "–ë—É—Å–¥—ã–Ω —Ö—ç–º–Ω—ç–ª–∏–π–≥ —Ö“Ø–Ω–¥—ç–ª",
        ],
      },
      ESTJ: {
        nick: "–ú–µ–Ω–µ–∂–µ—Ä",
        about: "–≠–º—Ö —Ü—ç–≥—Ü—Ç—ç–π, —à—É—É–¥, “Ø—Ä –¥“Ø–Ω–¥ —á–∏–≥–ª—ç—Å—ç–Ω.",
        strengths: ["“Æ–π–ª –∞–∂–∏–ª–ª–∞–≥–∞–∞ —Å–∞–π–Ω", "–•–∞—Ä–∏—É—Ü–ª–∞–≥–∞", "–®–∏–π–¥—ç–º–≥–∏–π"],
        growth: [
          "–°”©—Ä”©–≥ —Å–∞–Ω–∞–ª—ã–≥ —É—Ä—å",
          "–ü—Ä–æ—Ü–µ—Å—Å —É—è–Ω –±–æ–ª–≥–æ",
          "–î—É–ª–∞–∞–Ω—ã–≥ —Ç—ç–Ω—Ü–≤—ç—Ä–ª—ç",
        ],
      },
      ESFJ: {
        nick: "–≠–∑—ç–Ω",
        about: "–ê—Ä—á–ª–∞–≥—á, —Ö–∞–º—Ç—ã–Ω, –Ω–∏–π–≥—ç–º—á. –ë–∞–≥–∞–∞—Ä —Ö–æ–ª–±–æ–æ —Ç–æ–≥—Ç–æ–æ–Ω–æ.",
        strengths: [
          "–•–∞—Ä–∏–ª—Ü–∞–∞ –±–∞—Ä–∏–≥—á",
          "“Æ–π–ª—á–∏–ª–≥—ç—ç–Ω–¥ —á–∏–≥–ª—ç—Å—ç–Ω",
          "–ù–∞–π–¥–≤–∞—Ä—Ç–∞–π –¥–∞–≥–∞–ª—Ç",
        ],
        growth: ["”®”©—Ä–∏–π–≥”©”© –∞—Å–∞—Ä", "–ú–∞—Ä–≥–∞–∞–Ω—ã–≥ –∑”©–≤—à”©”©—Ä", "–ê–∞–∂–º–∞–∞—Ä —Ç—É—Ä—à"],
      },
      ENFJ: {
        nick: "–ú–µ–Ω—Ç–æ—Ä",
        about:
          "–≠–º–ø–∞—Ç, –Ω”©–ª”©”©–ª”©–≥—á, —ç—Ä—Ö—ç–º –∑–æ—Ä–∏–ª–≥–æ—Ç–æ–π. –ë—É—Å–¥—ã–Ω —à–∏–ª–¥—ç–≥ —Ç–∞–ª—ã–≥ –∏–ª –≥–∞—Ä–≥–∞–Ω–∞.",
        strengths: ["–ö–æ—É—á–∏–Ω–≥", "–•“Ø–º“Ø“Ø—Å–∏–π–≥ —É—è–ª–¥—É—É–ª–∞—Ö", "“Æ–Ω—ç —Ü—ç–Ω–∏–π–Ω –Ω–∏–π—Ü—ç–ª"],
        growth: [
          "–•—ç—Ç –∞—á–∞–∞–ª–∞–ª –±–∏—Ç–≥–∏–π –∞–≤",
          "–•–∏–ª—ç—ç —Ç–æ–¥ —Ç–æ–≥—Ç–æ–æ",
          "–¶—ç–Ω—ç–≥ –∞–≤–∞—Ö –∑–∞–≤—Å–∞—Ä–ª–∞–≥–∞—Ç–∞–π",
        ],
      },
      ENTJ: {
        nick: "–ö–æ–º–∞–Ω–¥–ª–∞–≥—á",
        about: "–°—Ç—Ä–∞—Ç–µ–≥–∏—á, –∑–æ—Ä–∏–≥—Ç–æ–π, “Ø—Ä –∞—à–∏–≥—Ç–∞–π. –ë–∞—Ä–∏–≥–¥–∞—Ö —ë—Å—Ç–æ–π–≥ —Ö–∞—Ä–Ω–∞.",
        strengths: [
          "–¢–æ–º –∑—É—Ä–≥–∞–∞—Ä —Ö—ç—Ä—ç–≥–∂“Ø“Ø–ª—ç–ª—Ç",
          "–ò—Ç–≥—ç–ª—Ç—ç–π —à–∏–π–¥–≤—ç—Ä",
          "”®–Ω–¥”©—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç",
        ],
        growth: [
          "–ù–∞—Ä–∏–π–Ω ”©–Ω–≥”© –∞—è—Å—ã–≥ —Å–æ–Ω—Å",
          "–ñ–∏–∂–∏–≥ —è–ª–∞–ª—Ç—ã–≥ —Ç—ç–º–¥—ç–≥–ª—ç",
          "–•—É—Ä–¥—ã–≥ —Ç–∞–∞—Ä—É—É–ª",
        ],
      },
    };

    const TYPE_KEYS = Object.keys(TYPES);

    // Build Types directory
    const typesGrid = document.getElementById("typesGrid");
    TYPE_KEYS.forEach((code) => {
      const div = document.createElement("div");
      div.className = "type-card reveal";
      div.innerHTML = `<div class="code">${code}</div><div class="nick">${TYPES[code].nick}</div><div class="muted">${TYPES[code].about}</div>`;
      div.tabIndex = 0;
      div.role = "button";
      div.addEventListener("click", () => showTypeDetail(code));
      div.addEventListener("keypress", (e) => {
        if (e.key === "Enter") showTypeDetail(code);
      });
      typesGrid.appendChild(div);
      io.observe(div);
    });

    function showTypeDetail(code) {
      const data = TYPES[code];
      alert(`${code} ‚Äî ${data.nick}

${data.about}`);
    }

    // Compare dropdowns
    const cmpA = document.getElementById("cmpA");
    const cmpB = document.getElementById("cmpB");
    TYPE_KEYS.forEach((k) => {
      cmpA.add(new Option(`${k} ‚Äî ${TYPES[k].nick}`, k));
      cmpB.add(new Option(`${k} ‚Äî ${TYPES[k].nick}`, k));
    });
    cmpA.value = "INTJ";
    cmpB.value = "ENFP";
    const cmpACard = document.getElementById("cmpACard");
    const cmpBCard = document.getElementById("cmpBCard");
    function renderCmp() {
      const a = TYPES[cmpA.value],
        b = TYPES[cmpB.value];
      cmpACard.innerHTML = `<div class="code">${cmpA.value}</div><div class="nick">${a.nick}</div><div class="muted">${a.about}</div>`;
      cmpBCard.innerHTML = `<div class="code">${cmpB.value}</div><div class="nick">${b.nick}</div><div class="muted">${b.about}</div>`;
    }
    cmpA.onchange = renderCmp;
    cmpB.onchange = renderCmp;
    renderCmp();

    // ===== QUIZ ENGINE =====
    const QUESTIONS = [
      { t: "–û–ª–Ω—ã –¥—É–Ω–¥ –±–∞–π—Ö–∞–¥ –Ω–∞–¥–∞–¥ —ç—Ä—á —Ö“Ø—á ”©–≥–¥”©–≥.", axis: "EI", first: true },
      {
        t: "–ë–∏ –≥–∞–Ω—Ü–∞–∞—Ä–∞–∞ –±–∞–π—Ö–¥–∞–∞ –∏–ª“Ø“Ø —Ç–∞–π–≤–∞–Ω –±–∞–π–¥–∞–≥.",
        axis: "EI",
        first: false,
      },
      {
        t: "–ë–∏ –±–æ–ª–æ–º–∂–æ–æ—Å –∏–ª“Ø“Ø –±–æ–¥–∏—Ç –±–∞—Ä–∏–º—Ç–∞–¥ —Ç”©–≤–ª”©—Ä”©—Ö —Ö–∞–Ω–¥–ª–∞–≥–∞—Ç–∞–π.",
        axis: "SN",
        first: true,
      },
      {
        t: "–ë–∏ –±–∞–π–≥–∞–∞–≥–∞–∞—Å –∏–ª“Ø“Ø –±–æ–ª–æ—Ö—ã–≥ —Ç”©—Å”©”©–ª”©—Ö –¥—É—Ä—Ç–∞–π.",
        axis: "SN",
        first: false,
      },
      { t: "–•–∞—Ä —É—Ö–∞–∞–Ω–∞–∞—Ä –∏–ª“Ø“Ø —à–∏–π–¥–≤—ç—Ä –≥–∞—Ä–≥–∞–¥–∞–≥.", axis: "TF", first: true },
      {
        t: "–®–∏–π–¥–≤—ç—Ä –≥–∞—Ä–≥–∞—Ö–∞–¥ –±—É—Å–¥—ã–Ω –º—ç–¥—Ä—ç–º–∂–∏–π–≥ —Ç“Ø—Ä“Ø“Ø–Ω–¥ —Ç–∞–≤—å–¥–∞–≥.",
        axis: "TF",
        first: false,
      },
      { t: "–ó“Ø–≥—ç—ç—Ä —Å—É—É—Ö –¥—É—Ä–≥“Ø–π.", axis: "JP", first: true },
      {
        t: "–¢”©–ª”©–≤–ª”©–≥”©”© —É—è–Ω —Ö–∞—Ç–∞–Ω –Ω—ç—ç–ª—Ç—Ç—ç–π –±–∞–π—Ö–¥–∞–∞ —Å–∞–π—Ö–∞–Ω.",
        axis: "JP",
        first: false,
      },
      {
        t: "–°—ç—Ç–≥—ç–ª —Ö”©–¥”©–ª—Å”©–Ω “Ø–µ–¥—ç—ç –±–æ–¥–æ–ª–≥“Ø–π —è—Ä—å—á–∏—Ö–¥–∞–≥.",
        axis: "EI",
        first: true,
      },
      {
        t: "–°—ç—Ç–≥—ç–ª —Ö”©–¥”©–ª—Å”©–Ω —á —ç—Ö–ª—ç—ç–¥ –±–æ–¥–æ–∂ –¥–∞—Ä–∞–∞ –Ω—å —è—Ä—å–¥–∞–≥.",
        axis: "EI",
        first: false,
      },
      { t: "–¢—É—Ä—à–ª–∞–≥–∞–¥–∞–∞ –∏–ª“Ø“Ø –∏—Ç–≥—ç–¥—ç–≥.", axis: "SN", first: true },
      { t: "–ú”©—Ä —Ö–æ–æ—Ä–æ–Ω–¥ —É–Ω—à–∏—Ö –Ω—å –Ω–∞–¥–∞–¥ –∞–º–∞—Ä—Ö–∞–Ω.", axis: "SN", first: false },
      {
        t: "–°—ç—Ç–≥—ç–≥–¥—ç–ª –∏–ª—ç–Ω –¥–∞–ª–∞–Ω–≥“Ø–π, —à—É–ª—É—É–Ω –±–∞–π—Ö –Ω—å –¥—ç—ç—Ä.",
        axis: "TF",
        first: true,
      },
      { t: "–ó”©–≤ –±–∞–π—Ö—Ö–∞–∞—Å –∏–ª“Ø“Ø —ç–≤ –Ω—ç–≥–¥—ç–ª —á—É—Ö–∞–ª.", axis: "TF", first: false },
      {
        t: "To‚Äëdo –∂–∞–≥—Å–∞–∞–ª—Ç —Ö”©—Ç”©–ª–∂ —Ü—ç–≥—Ü—Ç—ç–π –±–∞–π—Ö –¥—É—Ä—Ç–∞–π.",
        axis: "JP",
        first: true,
      },
      {
        t: "–≠—Ü—Å–∏–π–Ω —Ö—É–≥–∞—Ü–∞–∞ –Ω–∞–¥–∞–¥ —Å–∞–Ω—É—É–ª–≥–∞ —à–∏–≥ –ª —Å–∞–Ω–∞–≥–¥–¥–∞–≥.",
        axis: "JP",
        first: false,
      },
      { t: "–ó–∞–≤–≥“Ø–π –Ω–∏–π–≥–º–∏–π–Ω –∞–º—å–¥—Ä–∞–ª–¥ –¥—É—Ä—Ç–∞–π.", axis: "EI", first: true },
      {
        t: "–û–ª–æ–Ω —Ö“Ø–Ω—Ç—ç–π —è—Ä—å—Å–Ω–∞–∞—Å –∏–ª“Ø“Ø –º—ç–¥–¥—ç–≥ —Ö“Ø–Ω—Ç—ç–π–≥—ç—ç —è—Ä–∏—Ö –Ω—å —Ç—É—Ö—Ç–∞–π.",
        axis: "EI",
        first: false,
      },
      {
        t: "–ë—É—Å–¥—ã–Ω –∞–Ω–∑–∞–∞—Ä–¥–∞–≥–≥“Ø–π –∑“Ø–π–ª—Å–∏–π–≥ –±–∏ –∞–Ω–∑–∞–∞—Ä–¥–∞–≥.",
        axis: "SN",
        first: true,
      },
      { t: "–ò—Ä—ç—ç–¥“Ø–π–≥—ç—ç —Ç–æ–º –∑—É—Ä–≥–∞–∞—Ä —Ö–∞—Ä–∞—Ö –∏–ª“Ø“Ø.", axis: "SN", first: false },
    ];

    const AXES = ["EI", "SN", "TF", "JP"];

    // Render quiz
    const quizList = document.getElementById("quizList");
    const quizBar = document.getElementById("quizBar");
    const qCounter = document.getElementById("qCounter");
    const backBtn = document.getElementById("backBtn");
    const clearBtn = document.getElementById("clearBtn");
    const finishBtn = document.getElementById("finishBtn");

    let answers = JSON.parse(localStorage.getItem("mbti-answers") || "{}");

    function renderQuiz() {
      quizList.innerHTML = "";
      QUESTIONS.forEach((q, i) => {
        const li = document.createElement("li");
        li.className = "card p-md reveal";
        io.observe(li);
        li.innerHTML = `
       <div class="question">${i + 1}. ${q.t}</div>
       <div class="muted" aria-hidden="true">–û–≥—Ç —Å–∞–Ω–∞–ª –Ω–∏–π–ª—ç—Ö–≥“Ø–π –±–∞–π–Ω–∞ ‚Ä¶ –Ø–∞—Ö–∞–≤ –¥—ç—ç –ª ‚Ä¶ –ï—Ä”©–Ω—Ö–∏–π–¥”©”© —Å–∞–Ω–∞–ª –Ω–∏–π–ª–∂ –±–∞–π–Ω–∞</div>
       <div class="scale" role="radiogroup" aria-label="${q.t}">
         ${[1, 2, 3, 4, 5, 6, 7]
           .map((v) => {
             const id = `q${i}-${v}`;
             const checked = answers[i] === v ? "checked" : "";
             const label = v === 1 ? "1" : v === 4 ? "–ì–æ–ª–¥–æ–æ" : "";
             return `<input id="${id}" type="radio" name="q${i}" value="${v}" ${checked} />
                   <label for="${id}" class="pill" title="${v}">${
               label || v
             }</label>`;
           })
           .join("")}
       </div>`;
        quizList.appendChild(li);
      });
      updateProgress();
    }

    function updateProgress() {
      const answered = Object.keys(answers).length;
      const pct = Math.round((100 * answered) / QUESTIONS.length);
      quizBar.style.width = pct + "%";
      qCounter.textContent = `${answered} / ${QUESTIONS.length}`;
      finishBtn.disabled = answered < QUESTIONS.length;
    }

    quizList.addEventListener("change", (e) => {
      const name = e.target.name;
      if (!name) return;
      const idx = Number(name.slice(1));
      answers[idx] = Number(e.target.value);
      localStorage.setItem("mbti-answers", JSON.stringify(answers));
      updateProgress();
    });

    // Fancy keyboard navigation

    backBtn.addEventListener("click", () =>
      window.scrollTo({ top: 0, behavior: "smooth" })
    );
    clearBtn.addEventListener("click", (e) => {
      if (confirm("–ë“Ø—Ö —Ö–∞—Ä–∏—É–ª—Ç—ã–≥ —Ü—ç–≤—ç—Ä–ª—ç—Ö “Ø“Ø?")) {
        answers = {};
        localStorage.removeItem("mbti-answers");
        renderQuiz();
      } else {
        ripple(e.currentTarget);
      }
    });
    finishBtn.addEventListener("click", (e) => {
      ripple(e.currentTarget);
      computeResults();
    });

    function computeResults() {
      const pref = { EI: 0, SN: 0, TF: 0, JP: 0 };
      QUESTIONS.forEach((q, i) => {
        const v = answers[i];
        if (!v) return;
        const score = v - 4;
        pref[q.axis] += q.first ? score : -score;
      });
      const pct = Object.fromEntries(
        ["EI", "SN", "TF", "JP"].map((ax) => [
          ax,
          clamp(Math.round(((pref[ax] + 9) / 18) * 100), 0, 100),
        ])
      );
      const code = `${pct.EI >= 50 ? "E" : "I"}${pct.SN >= 50 ? "S" : "N"}${
        pct.TF >= 50 ? "T" : "F"
      }${pct.JP >= 50 ? "J" : "P"}`;
      showResults(code, pct);
    }

    // ===== RESULTS RENDER =====
    const resultsSec = document.getElementById("results");
    const resType = document.getElementById("resType");
    const resNick = document.getElementById("resNick");
    const resBars = document.getElementById("resBars");
    const resAbout = document.getElementById("resAbout");
    const resStrengths = document.getElementById("resStrengths");
    const resGrowth = document.getElementById("resGrowth");
    const aboutCode = document.getElementById("aboutCode");

    function barHTML(labelL, labelR, pctL) {
      return `<div class="bar reveal"><span style="inset:0 ${
        100 - pctL
      }% 0 0"></span><div class="label"><span>${labelL}</span><span>${labelR}</span></div></div>`;
    }

    function showResults(code, pct) {
      resType.textContent = code;
      aboutCode.textContent = code;
      const data = TYPES[code] || {
        nick: "",
        about: "",
        strengths: [],
        growth: [],
      };
      resNick.textContent = data.nick;
      resAbout.textContent = data.about;
      resStrengths.innerHTML = (data.strengths || [])
        .map((s) => `<li class="reveal">${s}</li>`)
        .join("");
      resGrowth.innerHTML = (data.growth || [])
        .map((s) => `<li class="reveal">${s}</li>`)
        .join("");

      resBars.innerHTML = "";
      resBars.insertAdjacentHTML("beforeend", barHTML("E", "I", pct.EI));
      resBars.insertAdjacentHTML("beforeend", barHTML("S", "N", pct.SN));
      resBars.insertAdjacentHTML("beforeend", barHTML("T", "F", pct.TF));
      resBars.insertAdjacentHTML("beforeend", barHTML("J", "P", pct.JP));
      $$("#results .reveal").forEach((el) => io.observe(el));

      resultsSec.style.display = "";
      const payload = { code, pct, ts: Date.now() };
      localStorage.setItem("mbti-result", JSON.stringify(payload));
      renderLastResult();
      scrollToId("results");
      updateShareButtons(payload);
    }

    // ===== LAST RESULT CARD =====
    const lastResult = document.getElementById("lastResult");
    const lastResultNote = document.getElementById("lastResultNote");
    const lastType = document.getElementById("lastType");
    const lastNickname = document.getElementById("lastNickname");
    const lastBars = document.getElementById("lastBars");
    const restartBtn = document.getElementById("restartBtn");

    function renderLastResult() {
      const saved = JSON.parse(localStorage.getItem("mbti-result") || "null");
      if (!saved) {
        lastResult.style.display = "none";
        lastResultNote.style.display = "";
        return;
      }
      lastResultNote.style.display = "none";
      lastResult.style.display = "grid";
      lastType.textContent = saved.code;
      lastNickname.textContent = TYPES[saved.code]?.nick || "";
      lastBars.innerHTML = "";
      lastBars.insertAdjacentHTML("beforeend", barHTML("E", "I", saved.pct.EI));
      lastBars.insertAdjacentHTML("beforeend", barHTML("S", "N", saved.pct.SN));
      lastBars.insertAdjacentHTML("beforeend", barHTML("T", "F", saved.pct.TF));
      lastBars.insertAdjacentHTML("beforeend", barHTML("J", "P", saved.pct.JP));
      $$("#lastBars .reveal").forEach((el) => io.observe(el));
    }

    restartBtn.addEventListener("click", (e) => {
      ripple(e.currentTarget);
      answers = {};
      localStorage.removeItem("mbti-answers");
      renderQuiz();
      scrollToId("quiz");
    });

    // ===== SHARING =====
    const shareBtn = document.getElementById("shareBtn");
    const copyLink = document.getElementById("copyLink");
    const shareResult = document.getElementById("shareResult");

    function buildResultURL(code, pct) {
      const params = new URLSearchParams();
      params.set("code", code);
      params.set("ei", pct.EI);
      params.set("sn", pct.SN);
      params.set("tf", pct.TF);
      params.set("jp", pct.JP);
      return location.origin + location.pathname + "#" + params.toString();
    }

    function parseHash() {
      if (!location.hash) return null;
      const qs = location.hash.slice(1);
      const p = new URLSearchParams(qs);
      const code = p.get("code");
      if (!code || !TYPES[code]) return null;
      const pct = {
        EI: +p.get("ei"),
        SN: +p.get("sn"),
        TF: +p.get("tf"),
        JP: +p.get("jp"),
      };
      return { code, pct };
    }

    function updateShareButtons(payload) {
      const url = buildResultURL(payload.code, payload.pct);
      copyLink.onclick = async () => {
        await navigator.clipboard.writeText(url);
        alert("–•–æ–ª–±–æ–æ—Å —Ö—É—É–ª–∞–≥–¥–ª–∞–∞!");
      };
      shareResult.onclick = async () => {
        if (navigator.share) {
          await navigator.share({
            title: "–ú–∏–Ω–∏–π MBTI –¥“Ø–Ω",
            text: `${payload.code} ‚Äî ${TYPES[payload.code]?.nick}`,
            url,
          });
        } else {
          await navigator.clipboard.writeText(url);
          alert("–•—É–≤–∞–∞–ª—Ü–∞—Ö –±–æ–ª–æ–º–∂–≥“Ø–π —Ç—É–ª —Ö–æ–ª–±–æ–æ—Å —Ö—É—É–ª–ª–∞–∞!");
        }
      };
      shareBtn.onclick = shareResult.onclick;
    }

    // On load
    window.addEventListener("load", () => {
      renderQuiz();
      renderLastResult();
      const shared = parseHash();
      if (shared) {
        showResults(shared.code, shared.pct);
      }
    });
  </script>
</html>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  /* Existing styles remain unchanged ... */

  /* ===== ADDITIONAL RESPONSIVE STYLES ===== */
  @media (max-width: 1200px) {
    .container {
      padding-inline: 1rem;
    }
  }

  @media (max-width: 768px) {
    .nav {
      flex-direction: column;
      gap: 0.5rem;
    }
    .controls {
      margin-top: 0.5rem;
      justify-content: flex-start;
      flex-wrap: wrap;
    }
    .hero-grid {
      grid-template-columns: 1fr !important;
    }
    .features {
      grid-template-columns: 1fr !important;
    }
    .grid.cols-2,
    .grid.cols-3,
    .grid.cols-4 {
      grid-template-columns: 1fr !important;
    }
    .quiz-controls {
      flex-direction: column;
      gap: 0.5rem;
    }
    .quiz-controls .right {
      justify-content: flex-start;
    }
  }

  @media (max-width: 480px) {
    .title {
      font-size: clamp(1.5rem, 5vw, 2rem);
    }
    .subtitle {
      font-size: clamp(0.9rem, 3.5vw, 1.1rem);
    }
    .btn {
      padding: 0.5rem 0.75rem;
      font-size: 0.9rem;
    }
    .scale {
      grid-template-columns: repeat(7, 1fr);
      gap: 0.25rem;
    }
    .pill {
      padding: 0.45rem 0.35rem;
      font-size: 0.7rem;
    }
  }
</style>
